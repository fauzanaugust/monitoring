<div class="col-md-12 order-md-2">
    <div id='mapid' style='width: 100%; height: 800px;'></div>
</div>

<div class="container marketing">

    <hr class="featurette-divider">

</div><!-- /.container -->

<script>
    var mymap = L.map('mapid').setView([-6.1965, 106.5920], 16);
    var kelJatiuwung = {
  "type": "FeatureCollection",
  "features": [
    {
      "type": "Feature",
      "properties": {
        "stroke": "#ff0000",
        "stroke-width": 2,
        "stroke-opacity": 1,
        "fill": "#f5cccc",
        "fill-opacity": 0.2,
        "ENTITY": "Polyline"
      },
      "geometry": {
        "type": "MultiPolygon",
        "coordinates": [
          [
            [
              [
                106.59257787200862,
                -6.202783404323804
              ],
              [
                106.59237532233354,
                -6.202832939041347
              ],
              [
                106.59212553952165,
                -6.202893400223213
              ],
              [
                106.5917247755202,
                -6.202912693554842
              ],
              [
                106.59148047450105,
                -6.202926467082063
              ],
              [
                106.5903659999645,
                -6.202822389405415
              ],
              [
                106.59014627734456,
                -6.202784021715986
              ],
              [
                106.58898600891159,
                -6.202596662431868
              ],
              [
                106.5885072316423,
                -6.202555091029181
              ],
              [
                106.58800859226638,
                -6.202562530108319
              ],
              [
                106.58808002296806,
                -6.202931432361917
              ],
              [
                106.58798198801651,
                -6.20352349630272
              ],
              [
                106.58777381827615,
                -6.203472953893797
              ],
              [
                106.5868373893634,
                -6.203350033299797
              ],
              [
                106.58584776984168,
                -6.203233233358189
              ],
              [
                106.58577595424086,
                -6.203224658736369
              ],
              [
                106.5853767120123,
                -6.203172335987503
              ],
              [
                106.58545586296275,
                -6.202565097951744
              ],
              [
                106.58554436797148,
                -6.201975579416078
              ],
              [
                106.58564738811859,
                -6.201682943981008
              ],
              [
                106.58573727613357,
                -6.201249099051322
              ],
              [
                106.58583184267582,
                -6.200421563180019
              ],
              [
                106.58595797255447,
                -6.199575071589302
              ],
              [
                106.58603361585176,
                -6.19910572071882
              ],
              [
                106.5862916248466,
                -6.197991380452443
              ],
              [
                106.58634341495024,
                -6.197829396341546
              ],
              [
                106.58650657392435,
                -6.197568507054861
              ],
              [
                106.58666654897127,
                -6.197354126197516
              ],
              [
                106.58679954966784,
                -6.197097876829281
              ],
              [
                106.58686270621999,
                -6.196861604653789
              ],
              [
                106.58694249791894,
                -6.196655278425038
              ],
              [
                106.58696908024778,
                -6.196495547757433
              ],
              [
                106.58697903826338,
                -6.196372423762353
              ],
              [
                106.5870037338703,
                -6.195719237367707
              ],
              [
                106.58706121104603,
                -6.195301430213542
              ],
              [
                106.58709029567677,
                -6.195155031978196
              ],
              [
                106.58715861209454,
                -6.194999278948703
              ],
              [
                106.58724717273864,
                -6.194811867741629
              ],
              [
                106.58733402466426,
                -6.19463798045279
              ],
              [
                106.58737216088518,
                -6.194508176665897
              ],
              [
                106.58743521424024,
                -6.194192873429475
              ],
              [
                106.58744332800492,
                -6.194141677865678
              ],
              [
                106.58746111265391,
                -6.194006787320948
              ],
              [
                106.58746109757567,
                -6.193915165546223
              ],
              [
                106.5874483675063,
                -6.193848996369919
              ],
              [
                106.58741528721086,
                -6.193785375597649
              ],
              [
                106.58735422433999,
                -6.193719214364606
              ],
              [
                106.58723972847365,
                -6.193576710442962
              ],
              [
                106.58718731635267,
                -6.19352407743246
              ],
              [
                106.58756479076916,
                -6.193192337570383
              ],
              [
                106.58790407261958,
                -6.19285884436561
              ],
              [
                106.58827364640135,
                -6.192492002198049
              ],
              [
                106.58864494256672,
                -6.192126219884766
              ],
              [
                106.5889569620847,
                -6.191835168024549
              ],
              [
                106.58907522563574,
                -6.191719326113163
              ],
              [
                106.58961610043278,
                -6.191193715356618
              ],
              [
                106.5897489667965,
                -6.191064223964316
              ],
              [
                106.58978456348977,
                -6.191019403830092
              ],
              [
                106.58993538268247,
                -6.190875953783299
              ],
              [
                106.59002362247593,
                -6.190779170127299
              ],
              [
                106.59043222236905,
                -6.190325454288882
              ],
              [
                106.5905180997879,
                -6.190238406938668
              ],
              [
                106.59092667809233,
                -6.189785825175892
              ],
              [
                106.59134792399826,
                -6.189326323058311
              ],
              [
                106.59150367067613,
                -6.189195408179874
              ],
              [
                106.59164618353421,
                -6.189098416305276
              ],
              [
                106.59176247799914,
                -6.189042497422333
              ],
              [
                106.59182860775708,
                -6.189019670160155
              ],
              [
                106.59191868326684,
                -6.189001401908983
              ],
              [
                106.59200950953462,
                -6.188992617114197
              ],
              [
                106.59234702338279,
                -6.189015374358557
              ],
              [
                106.59280852283062,
                -6.189071217765377
              ],
              [
                106.59341271213685,
                -6.189148602106027
              ],
              [
                106.59357462892157,
                -6.189166826264894
              ],
              [
                106.59420959520023,
                -6.189254500167638
              ],
              [
                106.59465429749828,
                -6.189310776196168
              ],
              [
                106.59488188656003,
                -6.189331497977403
              ],
              [
                106.59498304825733,
                -6.189337753964823
              ],
              [
                106.5951586417015,
                -6.189343996038635
              ],
              [
                106.59537562320241,
                -6.189341447705674
              ],
              [
                106.59572997495592,
                -6.189318257171811
              ],
              [
                106.5965134882253,
                -6.189266378300469
              ],
              [
                106.59682349085934,
                -6.189245447012426
              ],
              [
                106.59718292243049,
                -6.189211752271565
              ],
              [
                106.59740013373371,
                -6.189196191352706
              ],
              [
                106.59763026493653,
                -6.189128890929131
              ],
              [
                106.59787590518401,
                -6.189027958466916
              ],
              [
                106.59808017553269,
                -6.188950315210501
              ],
              [
                106.59862392027367,
                -6.188723492916732
              ],
              [
                106.59868520393579,
                -6.188837631288861
              ],
              [
                106.59868810965874,
                -6.189029995245781
              ],
              [
                106.59865945831835,
                -6.189294142861849
              ],
              [
                106.59861074330756,
                -6.189701849791919
              ],
              [
                106.59853360673175,
                -6.190369287174149
              ],
              [
                106.59849442775274,
                -6.190777666134021
              ],
              [
                106.5984611731565,
                -6.190981438637554
              ],
              [
                106.5983842090623,
                -6.191599548075427
              ],
              [
                106.59828289012783,
                -6.19244570375297
              ],
              [
                106.59827147669013,
                -6.192537434592748
              ],
              [
                106.59822033754408,
                -6.19297040534636
              ],
              [
                106.59819992085778,
                -6.193354694289303
              ],
              [
                106.59842053580954,
                -6.193450846689827
              ],
              [
                106.59855627675375,
                -6.193504621422519
              ],
              [
                106.59861006406729,
                -6.193543039939353
              ],
              [
                106.59862032503386,
                -6.193635266466873
              ],
              [
                106.59866405849117,
                -6.19385907741898
              ],
              [
                106.59876549089192,
                -6.194382206701608
              ],
              [
                106.59883578692144,
                -6.194632739538704
              ],
              [
                106.59887679767274,
                -6.194822312567279
              ],
              [
                106.5989146904379,
                -6.195157127949176
              ],
              [
                106.59892980660463,
                -6.195299349694719
              ],
              [
                106.59892801181635,
                -6.195328323784526
              ],
              [
                106.5989226256845,
                -6.195405760709638
              ],
              [
                106.59890824636203,
                -6.195524618520471
              ],
              [
                106.59889067060756,
                -6.195598273777406
              ],
              [
                106.5987120461408,
                -6.195741310611408
              ],
              [
                106.59847537011987,
                -6.195937984606396
              ],
              [
                106.59806243652538,
                -6.196257854838375
              ],
              [
                106.59795078908373,
                -6.196311501907903
              ],
              [
                106.59777215096257,
                -6.196383036649148
              ],
              [
                106.59764711070225,
                -6.196467967869479
              ],
              [
                106.59748634978412,
                -6.196606532067817
              ],
              [
                106.59709185950112,
                -6.196978186943415
              ],
              [
                106.59651194835907,
                -6.197471850986143
              ],
              [
                106.59640898199511,
                -6.197566713639479
              ],
              [
                106.59565962458001,
                -6.198208055489322
              ],
              [
                106.59508612824881,
                -6.198716368327374
              ],
              [
                106.59488359336203,
                -6.198891291141293
              ],
              [
                106.59452214401102,
                -6.199268591555694
              ],
              [
                106.59425368263099,
                -6.199554424079023
              ],
              [
                106.59409946232697,
                -6.199731638008098
              ],
              [
                106.59402235244019,
                -6.199822006536123
              ],
              [
                106.59385916443729,
                -6.199963513935394
              ],
              [
                106.59344818083129,
                -6.200373361619235
              ],
              [
                106.59333552545912,
                -6.200486109622822
              ],
              [
                106.59317182953865,
                -6.200686935454647
              ],
              [
                106.59311199705492,
                -6.200836663038948
              ],
              [
                106.5931417498761,
                -6.200950405356012
              ],
              [
                106.5931576127851,
                -6.201052562462208
              ],
              [
                106.5931770045135,
                -6.201198753363717
              ],
              [
                106.59318408165576,
                -6.201397787768295
              ],
              [
                106.59315632108981,
                -6.201501189605941
              ],
              [
                106.5930835565884,
                -6.201774411113429
              ],
              [
                106.59296889435811,
                -6.20240840134603
              ],
              [
                106.59289825992262,
                -6.202591358125378
              ],
              [
                106.59285425369825,
                -6.202635400267412
              ],
              [
                106.59276974694365,
                -6.202635415069107
              ],
              [
                106.592630657681,
                -6.202605495989441
              ],
              [
                106.59256728684359,
                -6.202658348387168
              ],
              [
                106.59257787200862,
                -6.202783404323804
              ]
            ]
          ]
        ]
      }
    }
  ]
}
    L.geoJSON(kelJatiuwung).addTo(mymap);

    L.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}', {
        attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',
        maxZoom: 18,
        id: 'mapbox/streets-v11',
        tileSize: 512,
        zoomOffset: -1,
        accessToken: 'pk.eyJ1IjoiZmF1emFuYXVndXN0IiwiYSI6ImNrZTN1aTVqazBtenQydnA4ZGU0eTEzdDcifQ.xFI1QjnDv75hMhCSZaBhdw'
    }).addTo(mymap);


    var kwtIcon = L.icon({
        iconUrl: '<?= base_url('assets/img/lamp.svg') ?>',
        iconSize: [48, 48],
    });

    var umkmIcon = L.icon({
        iconUrl: '<?= base_url('assets/img/lamp.svg') ?>',
        iconSize: [48, 48],
    });
    <?php
        $GET_LOKASI = $this->db->query("
                            SELECT
                                  u.`nama_kecamatan`,
                                  p.`nama_kelurahan`,
                                  k.`nama_alias`,
                                  k.`ketua`,
                                  k.`cp`,
                                  k.`legalitas`,
                                  k.`id_data`,
                                  k.`latitude`,
                                  k.`longitude`,
                                  k.`cp`,
                                  k.`alamat`
                                FROM
                                  `mst_data` k
                                  LEFT OUTER JOIN `kecamatan` u  ON k.`id_kecamatan` = u.`id_kecamatan`
                                  LEFT OUTER JOIN `kelurahan` p ON k.`id_kelurahan` = p.`id_kelurahan` WHERE tipe = 'kwt'
                            ");
        foreach($GET_LOKASI->result() as $rsData){ ?>

    L.marker([<?php echo $rsData->latitude ?>, <?php echo $rsData->longitude ?>], {
            icon: kwtIcon
        }).addTo(mymap)
        // .bindPopup("<b>Nama KWT :</b> <?php echo $rsData->nama_alias ?><br>" +
        //     "<b>Alamat :</b> <?php echo $rsData->alamat ?>, <?php echo $rsData->nama_kecamatan ?>, <?php echo $rsData->nama_kelurahan ?><br>" +
        //     "<b>Telepon :</b> <?php echo $rsData->cp ?> <br> "+
        //     "<img src=<?= base_url('assets/img/lamp.svg') ?> height=100px>");

            .bindPopup("<table border=\"1\"><tbody><tr><td width=\"40%\">Nama KWT</td><td>:</td><td width=\"70%\"><?php echo $rsData->nama_alias ?></td><td rowspan=\"3\"><img src=<?= base_url('assets/img/lamp.svg') ?> height=100px></td></tr>" +
                       "<tr><td>Alamat</td><td>:</td><td><?php echo $rsData->alamat ?>, <?php echo $rsData->nama_kecamatan ?>, <?php echo $rsData->nama_kelurahan ?></td></tr>" +
                        "<tr><td>Telp.</td><td>:</td><td><?php echo $rsData->cp ?></td></tr></tbody></table>");


    <?php } ?>

    <?php
        $GET_UMKM = $this->db->query("
                            SELECT
                                  u.`nama_kecamatan`,
                                  p.`nama_kelurahan`,
                                  k.`nama_alias`,
                                  k.`ketua`,
                                  k.`cp`,
                                  k.`legalitas`,
                                  k.`id_data`,
                                  k.`latitude`,
                                  k.`longitude`,
                                  k.`cp`,
                                  k.`alamat`
                                FROM
                                  `mst_data` k
                                  LEFT OUTER JOIN `kecamatan` u  ON k.`id_kecamatan` = u.`id_kecamatan`
                                  LEFT OUTER JOIN `kelurahan` p ON k.`id_kelurahan` = p.`id_kelurahan` WHERE tipe = 'umkm'
                            ");
        foreach($GET_UMKM->result() as $rsData){ ?>

    L.marker([<?php echo $rsData->latitude ?>, <?php echo $rsData->longitude ?>], {
            icon: umkmIcon
        }).addTo(mymap)
        .bindPopup("<b>Nama UMKM Pangan :</b> <?php echo $rsData->nama_alias ?><br>" +
            "<b>Alamat :</b> <?php echo $rsData->alamat ?>, <?php echo $rsData->nama_kecamatan ?>, <?php echo $rsData->nama_kelurahan ?><br>" +
            "<b>Telepon :</b> <?php echo $rsData->cp ?> ");
    <?php } ?>
</script>
